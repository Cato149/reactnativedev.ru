# Запуск на устройстве

Всегда полезно протестировать свое приложение на реальном устройстве, прежде чем выпускать его для пользователей. Этот документ проведет вас через необходимые шаги для запуска вашего приложения React Native на устройстве и подготовки его к производству.

!!!info ""

    Если вы использовали `create-expo-app` для создания проекта, вы можете запустить свое приложение на устройстве в Expo Go, отсканировав QR-код, который отображается при запуске `npm start`. Более подробную информацию см. в руководстве Expo Go [запуск проекта на устройстве](https://docs.expo.dev/workflow/run-on-device/).

=== "Android"

    ## Запуск вашего приложения на устройствах Android

    **Development OS**

    === "macOS"

    	### 1. Включите отладку по USB

    	Большинство устройств Android по умолчанию могут устанавливать и запускать только приложения, загруженные из Google Play. Вам нужно будет включить отладку по USB на вашем устройстве, чтобы установить ваше приложение во время разработки.

    	Чтобы включить отладку по USB на вашем устройстве, сначала вам нужно включить меню "Параметры разработчика", перейдя в **Настройки** → **О телефоне** → **Информация о программном обеспечении**, а затем семь раз коснуться строки `Номер сборки` внизу. Затем вы можете вернуться в **Настройки** → **Опции разработчика**, чтобы включить "Отладку USB".

    	### 2. Подключите устройство через USB

    	Теперь давайте настроим устройство Android для запуска наших проектов React Native. Подключите устройство через USB к вашей машине разработки.

    	Теперь проверьте, что устройство правильно подключено к ADB, отладочному мосту Android, запустив `adb devices`.

    	<!-- 0001.part.md -->

    	```shell
    	$ adb devices
    	List of devices attached
    	emulator-5554 offline   # Google emulator
    	14ed2fcc device         # Physical device
    	```

    	<!-- 0002.part.md -->

    	Если вы видите `device` в правой колонке, это означает, что устройство подключено. Одновременно должно быть подключено **только одно устройство**.

    	!!!note ""

    		Если в списке вы видите `unauthorized`, вам нужно запустить `adb reverse tcp:8081 tcp:8081` и нажать кнопку enable USB debugging on the device.

    	### 3. Запустите ваше приложение

    	Введите следующее в командной строке, чтобы установить и запустить ваше приложение на устройстве:

    	<!-- 0003.part.md -->

    	```shell
    	$ npx react-native run-android
    	```

    	<!-- 0004.part.md -->

    	!!!warning ""

    		Если вы получаете ошибку "конфигурация моста недоступна", смотрите [Использование adb reverse](running-on-device.md#method-1-using-adb-reverse-recommended).

    	!!!warning ""

    		Подсказка: Вы также можете использовать `React Native CLI` для генерации и запуска `Release` сборки (например, `npx react-native run-android --mode=release`).

    	## Подключение к серверу разработки

    	Вы также можете быстро выполнить итерации на устройстве, подключившись к серверу разработки, запущенному на вашей машине разработки. Это можно сделать несколькими способами, в зависимости от того, есть ли у вас доступ к USB-кабелю или Wi-Fi сети.

    	### Способ 1: Использование adb reverse (рекомендуется).

    	Вы можете использовать этот метод, если ваше устройство работает под управлением Android 5.0 (Lollipop) или новее, у него включена отладка по USB, и оно подключено через USB к вашей машине разработки.

    	Выполните следующие действия в командной строке:

    	<!-- 0005.part.md -->

    	```shell
    	$ adb -s <device name> reverse tcp:8081 tcp:8081
    	```

    	<!-- 0006.part.md -->

    	Чтобы узнать имя устройства, выполните следующую команду adb:

    	<!-- 0007.part.md -->

    	```shell
    	$ adb devices
    	```

    	<!-- 0008.part.md -->

    	Теперь вы можете включить живую перезагрузку из [Dev Menu](debugging.md#accessing-the-dev-menu). Ваше приложение будет перезагружаться всякий раз, когда изменится код JavaScript.

    	### Способ 2: Подключение через Wi-Fi

    	Вы также можете подключиться к серверу разработки через Wi-Fi. Сначала вам потребуется установить приложение на ваше устройство с помощью USB-кабеля, но после этого вы сможете выполнять отладку по беспроводной сети, следуя следующим инструкциям. Перед началом работы вам понадобится текущий IP-адрес вашей машины разработки.

    	Вы можете найти IP-адрес в **Системные настройки (или Системные предпочтения)** → **Сеть**.

    	1.  Убедитесь, что ноутбук и телефон находятся в **одной и той же** сети Wi-Fi.
    	2.  Откройте приложение React Native на устройстве.
    	3.  Вы увидите [красный экран с ошибкой](debugging.md#in-app-errors-and-warnings). Это нормально. Следующие шаги исправят это.
    	4.  Откройте внутреннее меню приложения [Dev Menu](debugging.md#accessing-the-dev-menu).
    	5.  Перейдите в **Настройки устройства** → **Хост и порт сервера отладки для устройства**.
    	6.  Введите IP-адрес вашей машины и порт локального сервера отладки (например, 10.0.1.1:8081).
    	7.  Вернитесь в меню **Dev Menu** и выберите **Reload JS**.

    	Теперь вы можете включить живую перезагрузку из [Dev Menu](debugging.md#accessing-the-dev-menu). Ваше приложение будет перезагружаться всякий раз, когда код JavaScript изменится.

    	## Создание приложения для производства

    	Вы создали отличное приложение с помощью React Native, и теперь вам не терпится выпустить его в Play Store. Процесс такой же, как и для любого другого нативного приложения для Android, с некоторыми дополнительными соображениями, которые необходимо принять во внимание. Чтобы узнать больше, следуйте руководству по [созданию подписанного APK] (signed-apk-android.md).

    === "Windows"

    	### 1. Включите отладку через USB

    	Большинство устройств Android по умолчанию могут устанавливать и запускать только приложения, загруженные из Google Play. Вам нужно будет включить отладку по USB на вашем устройстве, чтобы установить ваше приложение во время разработки.

    	Чтобы включить отладку по USB на вашем устройстве, сначала вам нужно включить меню "Параметры разработчика", перейдя в **Настройки** → **О телефоне** → **Информация о программном обеспечении**, а затем семь раз коснуться строки `Номер сборки` внизу. Затем вы можете вернуться в **Настройки** → **Опции разработчика**, чтобы включить "Отладку USB".

    	<!-- 0009.part.md -->

    	### 2. Подключите устройство через USB

    	Теперь давайте настроим Android-устройство для запуска наших проектов React Native. Подключите устройство через USB к вашей машине разработки.

    	Теперь проверьте, что устройство правильно подключено к ADB, отладочному мосту Android, запустив `adb devices`.

    	<!-- 0010.part.md -->

    	```shell
    	$ adb devices
    	List of devices attached
    	emulator-5554 offline   # Google emulator
    	14ed2fcc device         # Physical device
    	```

    	<!-- 0011.part.md -->

    	Если вы видите `device` в правой колонке, это означает, что устройство подключено. Одновременно должно быть подключено **только одно устройство**.

    	### 3. Запустите ваше приложение

    	Введите следующее в командной строке, чтобы установить и запустить ваше приложение на устройстве:

    	<!-- 0012.part.md -->

    	```shell
    	$ npx react-native run-android
    	```

    	<!-- 0013.part.md -->

    	!!!warning ""

    		Подсказка: Вы также можете использовать `React Native CLI` для генерации и запуска `Release` сборки (например, `npx react-native run-android --mode=release`).

    	## Подключение к серверу разработки

    	Вы также можете быстро выполнить итерации на устройстве, подключившись к серверу разработки, запущенному на вашей машине разработки. Это можно сделать несколькими способами, в зависимости от того, есть ли у вас доступ к USB-кабелю или Wi-Fi сети.

    	### Способ 1: Использование adb reverse (рекомендуется).

    	Вы можете использовать этот метод, если ваше устройство работает под управлением Android 5.0 (Lollipop) или новее, у него включена отладка по USB, и оно подключено через USB к вашей машине разработки.

    	Выполните следующие действия в командной строке:

    	<!-- 0014.part.md -->

    	```shell
    	$ adb -s <device name> reverse tcp:8081 tcp:8081
    	```

    	<!-- 0015.part.md -->

    	Чтобы узнать имя устройства, выполните следующую команду adb:

    	<!-- 0016.part.md -->

    	```shell
    	$ adb devices
    	```

    	<!-- 0017.part.md -->

    	Теперь вы можете включить живую перезагрузку из [Dev Menu](debugging.md#accessing-the-dev-menu). Ваше приложение будет перезагружаться каждый раз, когда изменится код JavaScript.

    	### Способ 2: Подключение через Wi-Fi

    	Вы также можете подключиться к серверу разработки через Wi-Fi. Сначала вам потребуется установить приложение на ваше устройство с помощью USB-кабеля, но после этого вы сможете выполнять отладку по беспроводной сети, следуя следующим инструкциям. Перед началом работы вам понадобится текущий IP-адрес вашей машины разработки.

    	Откройте командную строку и введите `ipconfig`, чтобы узнать IP-адрес вашей машины ([подробнее](http://windows.microsoft.com/en-us/windows/using-command-line-tools-networking-information)).

    	1.  Убедитесь, что ноутбук и телефон находятся в **одной и той же** сети Wi-Fi.
    	2.  Откройте приложение React Native на своем устройстве.
    	3.  Вы увидите [красный экран с ошибкой](debugging.md#in-app-errors-and-warnings). Это нормально. Следующие шаги исправят это.
    	4.  Откройте внутреннее меню приложения [Dev Menu](debugging.md#accessing-the-dev-menu).
    	5.  Перейдите в **Настройки устройства** → **Хост и порт сервера отладки для устройства**.
    	6.  Введите IP-адрес вашей машины и порт локального сервера отладки (например, 10.0.1.1:8081).
    	7.  Вернитесь в меню **Dev Menu** и выберите **Reload JS**.

    	Теперь вы можете включить живую перезагрузку из [Dev Menu](debugging.md#accessing-the-dev-menu). Ваше приложение будет перезагружаться всякий раз, когда код JavaScript изменится.

    	## Создание приложения для производства

    	Вы создали отличное приложение с помощью React Native, и теперь вам не терпится выпустить его в Play Store. Процесс такой же, как и для любого другого нативного приложения для Android, с некоторыми дополнительными соображениями, которые необходимо принять во внимание. Чтобы узнать больше, следуйте руководству по [созданию подписанного APK](signed-apk-android.md).

    === "Linux"

    	### 1. Включите отладку через USB

    	Большинство устройств Android по умолчанию могут устанавливать и запускать только приложения, загруженные из Google Play. Вам нужно будет включить отладку по USB на вашем устройстве, чтобы установить ваше приложение во время разработки.

    	Чтобы включить отладку по USB на вашем устройстве, сначала вам нужно включить меню "Параметры разработчика", перейдя в **Настройки** → **О телефоне** → **Информация о программном обеспечении**, а затем семь раз коснуться строки `Номер сборки` внизу. Затем вы можете вернуться в **Настройки** → **Опции разработчика**, чтобы включить "Отладку USB".

    	<!-- 0018.part.md -->

    	### 2. Подключите устройство через USB

    	Теперь давайте настроим Android-устройство для запуска наших проектов React Native. Подключите устройство через USB к вашей машине разработки.

    	Затем проверьте код производителя с помощью `lsusb` (на mac необходимо сначала [установить lsusb](https://github.com/jlhonora/lsusb)). `lsusb` должен вывести примерно следующее:

    	<!-- 0019.part.md -->

    	```bash
    	$ lsusb
    	Bus 002 Device 002: ID 8087:0024 Intel Corp. Integrated Rate Matching Hub
    	Bus 002 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
    	Bus 001 Device 003: ID 22b8:2e76 Motorola PCS
    	Bus 001 Device 002: ID 8087:0024 Intel Corp. Integrated Rate Matching Hub
    	Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
    	Bus 004 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub
    	Bus 003 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
    	```

    	<!-- 0020.part.md -->

    	Эти линии представляют USB-устройства, подключенные в данный момент к вашему аппарату.

    	Вам нужна та строка, которая представляет ваш телефон. Если вы сомневаетесь, попробуйте отключить телефон от сети и запустить команду снова:

    	<!-- 0021.part.md -->

    	```bash
    	$ lsusb
    	Bus 002 Device 002: ID 8087:0024 Intel Corp. Integrated Rate Matching Hub
    	Bus 002 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
    	Bus 001 Device 002: ID 8087:0024 Intel Corp. Integrated Rate Matching Hub
    	Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
    	Bus 004 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub
    	Bus 003 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
    	```

    	<!-- 0022.part.md -->

    	Вы увидите, что после удаления телефона строка с моделью телефона ("Motorola PCS" в данном случае) исчезла из списка. Это та строка, которая нас интересует.

    	`Bus 001 Device 003: ID 22b8:2e76 Motorola PCS`.

    	Из приведенной выше строки нужно взять первые четыре цифры из ID устройства:

    	`22b8:2e76`.

    	В данном случае это `22b8`. Это идентификатор Motorola.

    	Вам нужно будет ввести это в правила udev, чтобы начать работу:

    	<!-- 0023.part.md -->

    	```shell
    	echo 'SUBSYSTEM=="usb", ATTR{idVendor}=="22b8", MODE="0666", GROUP="plugdev"' | sudo tee /etc/udev/rules.d/51-android-usb.rules
    	```

    	<!-- 0024.part.md -->

    	Убедитесь, что вы заменили `22b8` на идентификатор, полученный в приведенной выше команде.

    	Теперь проверьте, что ваше устройство правильно подключается к ADB, отладочному мосту Android, запустив `adb devices`.

    	<!-- 0025.part.md -->

    	```shell
    	$ adb devices
    	List of devices attached
    	emulator-5554 offline   # Google emulator
    	14ed2fcc device         # Physical device
    	```

    	<!-- 0026.part.md -->

    	Если вы видите `device` в правой колонке, это означает, что устройство подключено. Одновременно должно быть подключено **только одно устройство**.

    	### 3. Запустите ваше приложение

    	Введите следующее в командной строке, чтобы установить и запустить ваше приложение на устройстве:

    	<!-- 0027.part.md -->

    	```shell
    	$ npx react-native run-android
    	```

    	<!-- 0028.part.md -->

    	!!!warning ""

    		Если вы получаете ошибку "конфигурация моста недоступна", смотрите [Использование adb reverse](running-on-device.md#method-1-using-adb-reverse-recommended).

    	!!!warning ""

    		Подсказка: Вы также можете использовать `React Native CLI` для генерации и запуска `Release` сборки (например, `npx react-native run-android --mode=release`).

    	## Подключение к серверу разработки

    	Вы также можете быстро выполнить итерации на устройстве, подключившись к серверу разработки, запущенному на вашей машине разработки. Это можно сделать несколькими способами, в зависимости от того, есть ли у вас доступ к USB-кабелю или Wi-Fi сети.

    	### Способ 1: Использование adb reverse (рекомендуется)

    	Вы можете использовать этот метод, если ваше устройство работает под управлением Android 5.0 (Lollipop) или новее, у него включена отладка по USB, и оно подключено через USB к вашей машине разработки.

    	Выполните следующие действия в командной строке:

    	<!-- 0029.part.md -->

    	```shell
    	$ adb -s <device name> reverse tcp:8081 tcp:8081
    	```

    	<!-- 0030.part.md -->

    	Чтобы узнать имя устройства, выполните следующую команду adb:

    	<!-- 0031.part.md -->

    	```shell
    	$ adb devices
    	```

    	<!-- 0032.part.md -->

    	Теперь вы можете включить живую перезагрузку из [Dev Menu](debugging.md#accessing-the-dev-menu). Ваше приложение будет перезагружаться каждый раз, когда изменится код JavaScript.

    	### Способ 2: Подключение через Wi-Fi

    	Вы также можете подключиться к серверу разработки через Wi-Fi. Сначала вам потребуется установить приложение на ваше устройство с помощью USB-кабеля, но после этого вы сможете выполнять отладку по беспроводной сети, следуя следующим инструкциям. Перед началом работы вам понадобится текущий IP-адрес вашей машины разработки.

    	Откройте терминал и введите `/sbin/ifconfig`, чтобы узнать IP-адрес вашей машины.

    	1.  Убедитесь, что ноутбук и телефон находятся в **одной и той же** сети Wi-Fi.
    	2.  Откройте приложение React Native на своем устройстве.
    	3.  Вы увидите [красный экран с ошибкой](debugging.md#in-app-errors-and-warnings). Это нормально. Следующие шаги исправят это.
    	4.  Откройте внутреннее меню приложения [Dev Menu](debugging.md#accessing-the-dev-menu).
    	5.  Перейдите в **Настройки устройства** → **Хост и порт сервера отладки для устройства**.
    	6.  Введите IP-адрес вашей машины и порт локального сервера отладки (например, 10.0.1.1:8081).
    	7.  Вернитесь в меню **Dev Menu** и выберите **Reload JS**.

    	Теперь вы можете включить живую перезагрузку из [Dev Menu](debugging.md#accessing-the-dev-menu). Ваше приложение будет перезагружаться всякий раз, когда изменится код JavaScript.

    	## Создание приложения для производства

    	Вы создали отличное приложение с помощью React Native, и теперь вам не терпится выпустить его в Play Store. Процесс такой же, как и для любого другого нативного приложения для Android, с некоторыми дополнительными соображениями, которые необходимо принять во внимание. Чтобы узнать больше, следуйте руководству по [созданию подписанного APK](signed-apk-android.md).

=== "iOS"

    ## Запуск вашего приложения на устройствах iOS

    **Development OS**

    === "macOS"

    	### 1. Подключите устройство через USB

    	Подключите устройство iOS к Mac с помощью кабеля USB - Lightning. Перейдите в папку `ios` в вашем проекте, затем откройте файл `.xcodeproj`, или, если вы используете CocoaPods, откройте `.xcworkspace`, внутри него с помощью Xcode.

    	<!-- 0033.part.md -->

    	Если вы впервые запускаете приложение на устройстве iOS, вам может потребоваться зарегистрировать устройство для разработки. Откройте меню **Продукт** в меню Xcode, затем перейдите в раздел **Назначение**. Найдите и выберите свое устройство в списке. Xcode зарегистрирует ваше устройство для разработки.

    	### 2. Настройка подписи кода

    	Зарегистрируйтесь в [Apple developer account](https://developer.apple.com/), если у вас его еще нет.

    	Выберите ваш проект в Навигаторе проектов Xcode, затем выберите вашу основную цель (она должна иметь то же имя, что и ваш проект). Найдите вкладку "Общие". Перейдите в раздел "Подписание" и убедитесь, что в выпадающем списке "Команда" выбран ваш аккаунт разработчика Apple или команда. Сделайте то же самое для цели tests (она заканчивается на Tests и находится ниже вашей основной цели).

    	**Повторите** этот шаг для цели **Tests** в вашем проекте.

    	![RunningOnDeviceCodeSigning](RunningOnDeviceCodeSigning.png)

    	### 3. Сборка и запуск приложения

    	Если все настроено правильно, ваше устройство будет указано как цель сборки на панели инструментов Xcode, а также появится в панели Devices (`⇧⌘2`). Теперь вы можете нажать кнопку **Build and run** (`⌘R`) или выбрать **Run** из меню **Product**. Вскоре ваше приложение будет запущено на вашем устройстве.

    	![RunningOnDeviceReady](RunningOnDeviceReady.png)

    	!!!warning ""

    		Если у вас возникнут проблемы, пожалуйста, посмотрите документацию Apple [Launching Your App on a Device](https://developer.apple.com/library/content/documentation/IDEs/Conceptual/AppDistributionGuide/LaunchingYourApponDevices/LaunchingYourApponDevices.html#//apple_ref/doc/uid/TP40012582-CH27-SW4).

    	## Подключение к серверу разработки

    	Вы также можете быстро выполнять итерации на устройстве, используя сервер разработки. Для этого достаточно находиться в той же сети Wi-Fi, что и компьютер. Встряхните устройство, чтобы открыть [Dev Menu](debugging.md#accessing-the-dev-menu), затем включите Live Reload. Ваше приложение будет перезагружаться при каждом изменении кода JavaScript.

    	![DevMenu](DevMenu.png)

    	### Устранение неполадок

    	!!!warning ""

    		Если у вас возникли проблемы, убедитесь, что ваш Mac и устройство находятся в одной сети и могут связаться друг с другом. Многие открытые беспроводные сети с неавторизованными порталами настроены таким образом, что устройства не могут связаться с другими устройствами в сети. В этом случае вы можете воспользоваться функцией Personal Hotspot вашего устройства. Вы также можете передать подключение к Интернету (Wi-Fi/Ethernet) с вашего Mac на ваше устройство через USB и подключиться к бандлеру через этот туннель для очень высокой скорости передачи данных.

    	<!-- 0034.part.md -->

    	При попытке подключения к серверу разработки вы можете получить [красный экран с ошибкой](debugging.md#in-app-errors-and-warnings), говорящий:

    	!!!danger ""

    		Connection to `http://localhost:8081/debugger-proxy?role=client` timed out. Вы используете прокси-сервер узла? Если вы работаете на устройстве, проверьте, правильно ли вы указали IP-адрес в `RCTWebSocketExecutor.m`.

    	Для решения этой проблемы проверьте следующие пункты.

    	#### 1. Сеть Wi-Fi.

    	Убедитесь, что ваш ноутбук и ваш телефон находятся в **одной и той же** сети Wi-Fi.

    	#### 2. IP-адрес

    	Убедитесь, что скрипт сборки правильно определил IP-адрес вашей машины (например, 10.0.1.123).

    	![XcodeBuildIP](XcodeBuildIP.png)

    	Откройте вкладку **Report navigator**, выберите последний **Build** и найдите `IP=`, за которым следует IP-адрес. IP-адрес, который будет встроен в приложение, должен совпадать с IP-адресом вашей машины.

    	## Сборка приложения для производства

    	Вы создали отличное приложение с помощью React Native, и теперь вам не терпится выпустить его в App Store. Процесс такой же, как и для любого другого нативного приложения для iOS, с некоторыми дополнительными соображениями, которые необходимо принять во внимание. Чтобы узнать больше, следуйте руководству по [публикации в Apple App Store] (publish-to-app-store.md).

    === "Windows"

    	Для создания приложения для устройств iOS требуется компьютер Mac. Также вы можете обратиться к нашему руководству [environment setup guide](getting-started.md), чтобы узнать, как создать приложение с помощью Expo CLI, который позволит вам запустить ваше приложение с помощью клиентского приложения Expo.

    === "Linux"

    	Для создания приложения для устройств iOS требуется компьютер Mac. Также вы можете обратиться к нашему руководству [environment setup guide](getting-started.md), чтобы узнать, как создать приложение с помощью Expo CLI, который позволит вам запустить приложение с помощью клиентского приложения Expo.
